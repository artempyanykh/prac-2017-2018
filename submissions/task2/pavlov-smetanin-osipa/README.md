Задание prac-io-2

# Краткое описание задания

1. Считать данные из `training.csv`. Проверить, является ли ряд стационарным в широком смысле одним из следующих способов:
    - Провести визуальную оценку, отрисовав ряд и скользящую статистику(среднее, стандартное отклонение). Построить график на котором будет отображен сам ряд и различные скользящие статистики.
    - Провести тест Дики - Фуллера.
  2. Разложить временной ряд на тренд, сезональность, остаток в соответствии с аддитивной, мультипликативной моделями. Визуализировать их, оценить стационарность получившихся рядов.
  3. Проверить является ли временной ряд интегрированным порядка k. Если является, применить к нему модель ARIMA, подобрав необходимые параметры с помощью функции автокорреляции и функции частичной автокорреляции. Выбор параметров обосновать. Отобрать несколько моделей. Предсказать значения для тестовой выборки. Визуализировать их, посчитать `r2 score` для каждой из моделей. Произвести отбор наилучшей модели с помощью информационного критерия Акаике. Провести анализ получившихся результатов.
  4. Соблюсти PEP8.
  5. Использовать для визуализации библиотеки bokeh или seaborn.

# Используемая версия Python
Python 3.6.1

# Файлы проекта:
- **z2.ipynb** --- программма, реализующая задание
- **task2.pdf** --- теоретические сведения
- **README.md** --- описание проекта
# Реализация решения

## Используемые библиотеки
- **pandas**
  - pandas.read.csv('testing.csv', parse_dates=['Date'], index_col='Date') – считывает данные из csv-файла. Первый параметр – название файла; Второй – указывает название колонки, в которой находятся даты; Третий - Изменят индекс на значения в колонке 'Date'.
  - pandas.DataFrame.dropna(inplace=True) – удаляет пустые ячейки в данном дата –фрейме.
  - pandas.DataFrame.Iloc – объединяет массивы в один
  - pandas.DataFrame.diff(periods=1) – возвращает разностный ряд порядка 1
- **matplotlib**
  - matplotlib.pyplot.title
  - matplotlib.pyplot.show
  - matplotlib.pyplot.figure
  - matplotlib.pyplot.subplots
  - matplotlib.axes
- **statsmodels**
  - statsmodels.tsa.stattools.adfuller(d.iloc[:, 0].values, autolag='AIC') – осуществляет тест Дики-Фуллера. Первый параметр – данные для которых вызываем тест; Второй – оптимизирует число лагов.
  - statsmodels.tsa.seasonal.seasonal_decompose(d, model='additive') – раскладывает временной ряд на компоненты(тренд, сезонность, белый шум). Первый параметр – временной ряд; Второй – модель разложения.
  - statsmodels.graphics.tsaplots.plot_acf (d_diff1.values.squeeze(), lags=25, ax=ax1) – строит график функции автокорреляции. Первый параметр – массив значений временного ряда; Второй – число лагов; Третий – на каком графике рисуем.
  - statsmodels.graphics.tsaplots.plot_pacf (d_diff1, lags=25, ax=ax2) – строит частичную функцию автокорреляции.
  - statsmodels.tsa.arima_model.ARIMA (d, order=(1, 1, 1)) – применяет модель ARIMA с парамерами (1,1,1) для ряда d.
  - statsmodels.tsa.arima_model.ARIMA.fit – фильтр Калмана для модели ARIMA
  - statsmodels.tsa.arima_model.ARIMA.predict – строит прогноз для модели ARIMA.
  - statsmodels.tsa.arima_model.ARIMAResults.aic – выводит значение критерия Акаике 
- **sklearn**
  - sklearn.metrics.r2_score(testing, pred1) – считает R2 между тестовой выборкой и предсказанной
## Теоретический материал

Описан в файле **task2.pdf**


## Ход программы
1. Считывание данных произведено с помощью функции read_csv. Полученный временной ряд проверялся на стационарность в широком смысле с помощью теста Дики-Фуллера. В результате проведения теста ряд оказался нестационарным ввиду отсутствия единичных корней.
2. Временной ряд был разложен на тренд, сезональность и остаток в соответствии с аддитивной и мультипликативной моделями. Разложение продемонстрировано соответствующими графиками. При проверке на стационарность обе модели дали одинаковые результаты.
3. Временной ряд оказался интегрированным 1 порядка. Данный факт проверялся проведением теста Дики-Фуллера, выявившего стационарность инетгрированного ряда. Следовательно, параметр d в модели ARIMA(p,d,q) равен 1.
После изучения коррелограммы функции частичной автокорреляции можно сделать вывод, что p = 1, поскольку на ней только 1 лаг сильно отличнен от нуля. По коррелограмме функции автокорреляции можно увидеть, что q = 1, т.к. после лага 1 значении функций резко падают.
После построения модели ARIMA(1,1,1) получаем параметры R2 score = -3.28 и AIC= 248.73. Прогноз построен на графике.
Так же была рассмотрена модель ARIMA(10,1,1), для которой были получены R2 score = -0.059 и AIC= 245.81, что является лучшим результатом.
4. Соответствие PEP8 проверялось с помощью https://pep8.ru/doc/pep8/
5. Дополнительных библиотек для визуализации не использовалось.

# Инструкции по запуску

## Необходимое ПО
- Anaconda 3 - дистрибутив ЯП Python, содержащий всё необходимое, в том числе:
  - Jupyter
  - Python 3.6
  - Набор описанных выше библиотек

## Запуск(из окна терминала)
Из директории проекта:
```
jupyter-notebook task2_2.ipynb
```
В jupyter:
``` 
Cell > Run All
```

Задание выполнили:
- Павлов Антон
- Сметанин Даниил
- Осипа Андрей
