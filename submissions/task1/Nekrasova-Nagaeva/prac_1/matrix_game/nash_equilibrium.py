import numpy as np
from scipy.optimize import linprog

def nash_equilibrium(a):
  M = 0
  if a.min() <= 0:                            # Ð¡Ð´ÐµÐ»Ð°ÐµÐ¼ Ð²ÑÐµ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ñ‹ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñ‹ Ð½ÐµÐ¾Ñ‚Ñ€Ð¸Ñ†Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¼Ð¸,
    M = abs(a.min())                          # Ñ‚Ð°Ðº ÐºÐ°Ðº ÑÑ‚Ð¾ Ð½Ðµ Ð²Ð»Ð¸ÑÐµÑ‚ Ð½Ð° Ð¿Ñ€Ð¾Ñ†ÐµÑÑ Ð¿Ð¾Ð¸ÑÐºÐ° Ñ€ÐµÑˆÐµÐ½Ð¸Ñ
    a += M
  m = a.shape[0]                              # Ñ€Ð°Ð·Ð¼ÐµÑ€Ñ‹ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñ‹ (m*n)
  n = a.shape[1]

  c = np.ones((m))                            # Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ Ð¼Ð¸Ð½Ð¸Ð¼Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ F = x1+...+xm = 1/V
  A_ub = -a.T                                 # ÑÐ²Ð¾Ð´Ð¸Ð¼ Ðº Ð½ÐµÑ€Ð°Ð²ÐµÐ½ÑÑ‚Ð²Ð°Ð¼ â‰¤ Ð´Ð¾Ð¼Ð½Ð¾Ð¶ÐµÐ½Ð¸ÐµÐ¼ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñ‹ Ð¸
  b_ub = -np.ones((n))                        # Ð¿Ñ€Ð°Ð²Ð¾Ð¹ Ñ‡Ð°ÑÑ‚Ð¸ Ð½Ð° (-1)
                                    
  res = linprog(c, A_ub, b_ub)                # Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ linprog Ð¿Ð¾Ð»Ñ‡Ð°ÐµÐ¼
                                              # Ñ€ÐµÑˆÐµÐ½Ð¸Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸:
                                              #   ð‘ð‘‡*ð‘¥ â†’ ð‘šð‘–ð‘›
                                              #   ð´_ð‘¢ð‘*ð‘¥ â‰¤ ð‘_ð‘¢ð‘ 
                                              #   ð´_ð‘’ð‘ž*ð‘¥ = ð‘_ð‘’ð‘ž 
                                              #   ð‘¥ â‰¥ 0
  V = 1/res.fun - M   
  first_str = 1/res.fun * res.x                       
                                              
  c = -np.ones((n))                           # Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ Ð¼Ð°ÐºÑÐ¸Ð¼Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ F = y1+...yn = 1/V
  A_ub = a                                    # ÑÐ²ÐµÐ´ÐµÐ¼ Ð·Ð°Ð´Ð°Ñ‡Ñƒ Ðº Ð·Ð°Ð´Ð°Ñ‡Ðµ Ð¼Ð¸Ð½Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ð¸ 
  b_ub = np.ones((m)) 
  res = linprog(c, A_ub, b_ub)
  second_str = (-1/res.fun) * res.x
  return V, first_str, second_str
